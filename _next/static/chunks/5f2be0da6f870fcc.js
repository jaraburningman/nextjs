(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31713,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(89786),n=e.i(61756);function s(){let{setTitle:e,setDescription:s}=(0,r.useContext)(a.HeaderContext),{detectionIntervalRef:i}=(0,r.useContext)(n.AppContext);(0,r.useEffect)(()=>{e("Next.js playground + Facial Expressions"),s("OpenVINO MobileNet-SSD pretrained object detection model + face 68 landmark, recognition and expression models.")},[]);let c=(0,r.useRef)(null),o=(0,r.useRef)(null),l=(0,r.useRef)(null),d=(0,r.useRef)(null),[u,p]=(0,r.useState)([]),[f,h]=(0,r.useState)(!1),[x,m]=(0,r.useState)(!1),w=e=>e.charAt(0).toUpperCase()+e.slice(1),v=async()=>{try{d.current=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1}),c.current&&(c.current.srcObject=d.current)}catch(e){console.error(e)}};return(0,r.useEffect)(()=>{let e=document.createElement("script");return e.src="./face-api.js",e.defer=!0,e.onload=()=>{h(!0)},document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]),(0,r.useEffect)(()=>{f&&c.current&&o.current&&l.current&&(async()=>{try{await Promise.all([window.faceapi.nets.ssdMobilenetv1.loadFromUri("./models"),window.faceapi.nets.faceLandmark68Net.loadFromUri("./models"),window.faceapi.nets.faceRecognitionNet.loadFromUri("./models"),window.faceapi.nets.faceExpressionNet.loadFromUri("./models")]),await v(),m(!0)}catch(e){console.error("Error loading models:",e)}})()},[f]),(0,r.useEffect)(()=>{if(!f||!c.current||!o.current||!l.current)return;let e=c.current;o.current;let t=l.current,r=async()=>{let r=window.faceapi.createCanvasFromMedia(e);return r.getContext("2d",{willReadFrequently:!0}).clearRect(0,0,r.width,r.height),t.append(r),i.current=setInterval(async()=>{let a={width:t.offsetWidth,height:t.offsetHeight};window.faceapi.matchDimensions(r,a);let n=await window.faceapi.detectAllFaces(e).withFaceLandmarks().withFaceDescriptors().withFaceExpressions(),s=window.faceapi.resizeResults(n,a);0===n.length?p([]):(p(s.map(e=>{let t=[],r="",a=0;for(let[n,s]of Object.entries(e.expressions)){let e=w(n),i=Math.round(100*s);t.push({expressionName:e,expressionValue:i}),i>a&&(a=i,r=e)}return{title:r,data:t}})),s.forEach(e=>{let t=new window.faceapi.draw.DrawFaceLandmarksOptions({drawPoints:!0,pointSize:2,pointColor:"white",drawLines:!0,lineColor:"white",lineWidth:1});new window.faceapi.draw.DrawFaceLandmarks(e.landmarks,t).draw(r)}))},40),()=>clearInterval(i.current)};return e.addEventListener("play",r),()=>{e.removeEventListener("play",r)}},[f]),(0,r.useEffect)(()=>()=>{d.current&&d.current.getTracks().forEach(e=>e.stop()),clearInterval(i.current)},[]),(0,t.jsxs)("div",{className:"ex-app-container",children:[(0,t.jsx)("div",{className:"ex-container",children:x?0===u.length?(0,t.jsx)("div",{className:"ex-box",children:"Detecting faces ..."}):(0,t.jsxs)(t.Fragment,{children:[u.map((e,r)=>(0,t.jsx)("div",{className:"ex-box",children:(0,t.jsx)("table",{className:"ex-box-data",children:(0,t.jsx)("tbody",{children:e.data.map((r,a)=>(0,t.jsx)("tr",{children:(0,t.jsx)("td",{children:(0,t.jsx)("span",{style:r.expressionName===e.title?{fontWeight:"bold",color:"#c01f9c"}:{},children:`${r.expressionName} ${r.expressionValue}%`})})},a))})})},r)),1===u.length&&(0,t.jsx)("div",{className:"ex-box ex-ghost",children:(0,t.jsx)("span",{className:"ex-box-person",children:"#2"})})]}):(0,t.jsx)("div",{className:"ex-box",children:"Loading models"})}),(0,t.jsxs)("div",{id:"ex-video",ref:l,children:[(0,t.jsx)("video",{ref:c,width:"100%",autoPlay:!0}),(0,t.jsx)("canvas",{ref:o,style:{display:"none"}})]})]})}function i(){return(0,t.jsx)(s,{})}e.s(["default",()=>i],31713)}]);